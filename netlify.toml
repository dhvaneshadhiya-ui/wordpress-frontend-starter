# Netlify configuration for OG image generation and Image CDN

# Enable Image CDN for remote WordPress images
[images]
  remote_images = ["https://dev.igeeksblog.com/.*"]

[[edge_functions]]
  function = "og"
  path = "/og"

[[headers]]
  for = "/og"
  [headers.values]
    Cache-Control = "public, s-maxage=31536000, immutable"

# Block indexing via HTTP header (staging site)
[[headers]]
  for = "/*"
  [headers.values]
    X-Robots-Tag = "noindex, nofollow"

# Build settings
[build]
  command = "npm run build"
  publish = "dist"

# Handle clean URLs - serve index.html from subdirectories
[[redirects]]
  from = "/category/:slug"
  to = "/category/:slug/index.html"
  status = 200
  force = false

[[redirects]]
  from = "/tag/:slug"
  to = "/tag/:slug/index.html"
  status = 200
  force = false

[[redirects]]
  from = "/author/:slug"
  to = "/author/:slug/index.html"
  status = 200
  force = false

# Post slugs at root level (must be before SPA fallback)
[[redirects]]
  from = "/:slug"
  to = "/:slug/index.html"
  status = 200
  force = false

# SPA fallback - only if no file matches
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
  force = false
